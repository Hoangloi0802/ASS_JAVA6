<!DOCTYPE html>
<html lang="vi">

<head th:replace="~{/layouts/header}">
    <title>Trang chủ</title>
</head>

<body>
    <header th:replace="~{/layouts/nav}">
    </header>
    <main>
        <div class="row mb-3">
            <div class="container-fluid page-header py-5">
                <h1 class="text-center text-white display-6">GIỎ HÀNG CỦA BẠN</h1>
            </div>
        </div>

        <section class="mt-5 mt-lg-0" id="page-cart">
            <div class="container">
                <div class="row border-bottom py-2">
                    <div class="col-sm-6 col-12">
                        <h6 class="fs-6 text-uppercase mb-0">Sản phẩm</h6>
                    </div>
                    <div class="col-sm-6 col-12 d-flex justify-content-sm-end">
                        <div class="col-sm-4 col-4 text-center">
                            <h6 class="fs-6 text-uppercase mb-0">Số lượng</h6>
                        </div>
                        <div class="col-sm-4 col-4 text-center">
                            <h6 class="fs-6 text-uppercase mb-0">Giá</h6>
                        </div>
                        <div class="col-sm-4 col-4 text-center">
                            <h6 class="fs-6 text-uppercase mb-0">Hành động</h6>
                        </div>
                    </div>
                </div>
                <th:block th:each="item : ${cartItems}">
                    <div class="row align-items-center py-3 border-bottom">
                        <div class="col-sm-6 col-12 d-flex align-items-center">
                            <img class="me-3"  th:src="${item.product.productImages[0].imageUrl}" 
                                alt="Product Image" width="50">
                            <div>
                                <h5 class="fw-bold mb-0" th:text="${item.product.name}"></h5>
                            </div>
                        </div>
                
                        <div class="col-sm-6 col-12 mt-3 mt-sm-0 d-flex align-items-center justify-content-sm-end">
                            <div class="col-sm-6 col-6 text-center">
                                <form th:action="@{/giohang/update}" method="post">
                                    <input type="hidden" name="productId" th:value="${item.product.id}" />
                
                                    <div class="d-flex align-items-center gap-2 justify-content-center">
                                        <!-- Nút giảm số lượng -->
                                        <button type="submit" name="change" value="-1"
                                            class="btn btn-outline-dark btn-sm px-3 py-2">-</button>
                
                                        <!-- Hiển thị số lượng -->
                                        <input type="text" name="quantity" th:value="${item.quantity}"
                                            class="form-control form-control-sm text-center"
                                            style="width: 80px; height: 40px;" readonly />
                
                                        <!-- Nút tăng số lượng -->
                                        <button type="submit" name="change" value="1"
                                            class="btn btn-outline-dark btn-sm px-3 py-2">+</button>
                                    </div>
                                </form>
                            </div>
                
                            <div class="col-sm-3 col-3 text-end">
                                <h6 class="fs-6 fw-normal mb-0"
                                    th:text="${#numbers.formatDecimal(item.price * item.quantity, 0, 'COMMA', 0, 'POINT')} + ' VNĐ'">
                                </h6>
                            </div>
                
                            <!-- Nút xóa sản phẩm -->
                            <div class="col-sm-3 col-3 text-end">
                                <form th:action="@{/giohang/remove}" method="post">
                                    <input type="hidden" name="productId" th:value="${item.product.id}" />
                                    <button type="submit" class="btn btn-sm btn-danger">Xóa</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </th:block>
                


                <div class="row justify-content-end text-end mt-4">
                    <div class="col-md-8 col-lg-6">
                        <div class="row justify-content-end mt-2">
                            <div class="col-6">
                                <h4 class="fw-normal text-body">Tạm tính:</h4>
                            </div>
                            <div class="col-4">
                                <h4 class="fw-normal" id="totalPrice"
                                    th:text="${#numbers.formatDecimal(totalPrice, 0, 'COMMA', 0, 'POINT')} + ' VNĐ'">
                                </h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 px-0">
                        <hr class="mb-0">
                        <hr class="mt-1">
                    </div>
                    <div class="col-md-8 col-lg-6">
                        <div class="row justify-content-end mt-4">
                            <div class="col-10 col-sm-8 d-grid">
                                <a class="btn btn-lg btn-danger" href="#!">Đặt hàng ⟶</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div th:replace="~{/layouts/footer}">
    </div>
    
</body>

</html>